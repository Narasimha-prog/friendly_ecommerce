
handling exceptions
----------------
Controller
   â†“
Application Service
   â†“
Domain (Entity / VO)
   âŒ throws InvalidEmailException
   â†‘
Application catches (optional)
   â†‘
Controller maps â†’ 400 Bad Request


value Objects
------------
Compare Entity vs Value Object (this is key)
ğŸ”¹ Entity

Identity = ID

Properties can change

Equality = ID-based

User(id=123, email=a@b.com)
User(id=123, email=c@d.com)  // SAME entity

ğŸ”¹ Value Object

Identity = all its properties

Immutable

Equality = value-based

Email("a@b.com") â‰  Email("c@d.com")
Address("A", "B", "C", "D") â‰  Address("A", "B", "X", "D")


Change any property â†’ itâ€™s a different value


Entities have identity â€” the identity itself is often a Value Object.
=========================
User u1 = new User(new UserId(uuid1));
User u2 = new User(new UserId(uuid1));

u1.equals(u2); // true (same identity)


Typical User Aggregate (realistic)
User
 â”œâ”€ UserId        (VO)
 â”œâ”€ Name          (VO)
 â”œâ”€ Email         (VO)
 â”œâ”€ Password      (VO)
 â”œâ”€ Address       (VO)
 â””â”€ Status        (enum)


This is not overengineering â€” this is standard DDD.


[Your Application / System Logs] â†’ [Logstash] â†’ [Elasticsearch] â†’ [Kibana]


mvn clean verify sonar:sonar \
  -Dsonar.projectKey=friendly_ecommerce \
  -Dsonar.host.url=http://localhost:9000 \
  -Dsonar.login=sqp_3f33e2412f61a8796a8457af11bd0c0e0e77309b



  mvn clean verify sonar:sonar \
    -Dsonar.login=sqp_72b495fa33256b05d6766bb9314b1ecadbbd118d


mvn sonar:sonar \
  -Dsonar.projectKey=friendly_ecommerce \
  -Dsonar.host.url=http://localhost:9000 \
  -Dsonar.login=sqp_73d5f2758b1d2b29b90e7b2e3d5cc5049016085a



Logstash starts
   â†“
Reads logstash.yml
   â†“
Authenticates to ES (license, monitoring)
   â†“
Startup OK?
   â†“
Loads pipelines
   â†“
Pipelines authenticate again (for data)



Access Requirement	User	Response
permitAll()	anonymous	200 OK
authenticated()	anonymous	403 Forbidden
hasRole("USER")	anonymous	403 Forbidden
authenticated()	invalid token	401 Unauthorized
hasRole("USER")	valid token, wrong role	403 Forbidden



HTTP Request
 â†“
Servlet Container (Tomcat)
 â†“
Registered Servlet Filters
   â”œâ”€â”€ Custom Filter (if registered)
   â”œâ”€â”€ DelegatingFilterProxy     Only ONE servlet filter is registered
                                 That filter delegates to Spring-managed security filters
   â”‚     â””â”€â”€ Spring Security Filter Chain
   â”‚           â”œâ”€â”€ Authentication filters
   â”‚           â”œâ”€â”€ Authorization filters
   â”‚           â””â”€â”€ Security context filters
 â†“
DispatcherServlet
 â†“
Controller

Servlet Container
 â”œâ”€â”€ Filter A (auto-registered)
 â”œâ”€â”€ Filter B (via FilterRegistrationBean)
 â””â”€â”€ DelegatingFilterProxy (Spring Security)


@Bean
public FilterRegistrationBean<MyFilter> myFilter() {
    FilterRegistrationBean<MyFilter> frb = new FilterRegistrationBean<>();
    frb.setFilter(new MyFilter());
    frb.setEnabled(true);
    return frb;
}


âŒ Do NOT annotate the filter with @Component in this case


OncePerRequestFilter is NOT a servlet filter by itself

It becomes active only when added to Spring Securityâ€™s filter chain:

http.addFilterBefore(jwtFilter, UsernamePasswordAuthenticationFilter.class);


If you donâ€™t add it to security:
â¡ï¸ it does nothing




Ordered.HIGHEST_PRECEDENCE = Integer.MIN_VALUE
Ordered.LOWEST_PRECEDENCE  = Integer.MAX_VALUE
Meaning
Constant	Value	Behavior
HIGHEST_PRECEDENCE	-2147483648	Runs FIRST
LOWEST_PRECEDENCE	+2147483647	Runs LAST

low values means Highest priority



HIGHEST_PRECEDENCE filter â†’ runs first    -2147483648(Bean)
DelegatingFilterProxy (Security) â†’ runs second  -100
Custom FRB (order=1) â†’ runs third
Auto @Component â†’ runs last                +26123434 LOWEST_PRECEDENCE (Integer.MAX_VALUE)
                                                     Last


Annotation	Purpose
@EnableWebSecurity	Enable Spring Security + allow custom config
@Configuration	Just marks a class as a Spring bean provider
@EnableGlobalMethodSecurity	Enable @PreAuthorize etc. on methods


 --for config properties--
allowed-origins	kebab-case	âœ…
allowedOrigins	camelCase	âŒ
allowed_origins	snake_case	âŒ
AllowedOrigins	PascalCase	âŒ
Allowed-Origins	Upper kebab-case	âŒ
allowedOrigIns	mixed case	âŒ


          Client
            |
       Coordinating Node
            |
   +--------+--------+
   |        |        |
Data Node1 Data Node2 Data Node3
   |        |        |
 Master Node (1 elected)


http://localhost:9200/_cat/indices?v  for es

http://localhost:5601  fo kibana

||| ---> | insert click to change